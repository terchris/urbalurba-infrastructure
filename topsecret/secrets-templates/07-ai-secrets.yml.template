# AI/ML Services Secrets Template
# Contains secrets for AI/ML services (OpenWebUI, LiteLLM)
# Generated from template - DO NOT EDIT MANUALLY
# Edit default-templates/07-ai-secrets.yml.template instead

---
# Define the ai namespace first
apiVersion: v1
kind: Namespace
metadata:
  name: ai

---
# secrets for ai namespace
apiVersion: v1
kind: Secret
metadata:
  name: urbalurba-secrets
  namespace: ai
type: Opaque
stringData:
  # ================================================================
  # OPEN-WEBUI CONFIGURATION
  # ================================================================

  # These are for the script that creates the database for openwebui and enables the vector functionality u06-openwebui-create-postgres.yml
  OPENWEBUI_POSTGRES_USER: openwebui
  OPENWEBUI_POSTGRES_PASSWORD: "${DEFAULT_DATABASE_PASSWORD}"
  OPENWEBUI_POSTGRES_DB: openwebui

  # This is the connection string in full that openwebui uses to connect to the database
  DATABASE_URL: postgresql://openwebui:${DEFAULT_DATABASE_PASSWORD}@${PGHOST}:5432/openwebui

  # for OpenAI API integration - OpenAI API key for embeddings and models  The default value in open-webui helm is "0p3n-w3bu!"
  OPENWEBUI_OPENAI_API_KEY: "sk-SecretPassword1"

  # LiteLLM provider API keys
  AZURE_API_KEY: "azure-key-placeholder"
  AZURE_API_BASE: "https://your-endpoint.openai.azure.com"
  OPENAI_API_KEY: "openai-key-placeholder"
  ANTHROPIC_API_KEY: "your-anthropic-api-key-here"
  # LiteLLM master key - this needs to match OPENWEBUI_OPENAI_API_KEY for the integration to work
  LITELLM_PROXY_MASTER_KEY: "sk-1234567890abcdef"  # Must follow format: sk-[alphanumeric] for LiteLLM validation

  # ================================================================
  # AUTH PROVIDER FOR OPENWEBUI (AUTHENTIK)
  # ================================================================
  # This is how to set up manually in Authentik UI:
  # Before deploying this secret, configure in Authentik UI (authentik.localhost):
  # 1. Applications > Applications > Create with Provider
  # 1.1 Name: "openwebui-dev"
  # 1.2 Slug: "openwebui-dev"
  # 1.3 click Next
  # 2. Provider Type: "OAuth2/OpenID Connect"
  # 2.1 click Next
  # 3. Name: "openwebui-dev-provider"
  # 3.1 Authentication Flow: "default-provider-authorization-implicit-consent (Authorize Application)"
  # 3.2 Client Type: "Confidential"
  # 3.3 Client ID: 1c37QuM0qm0g2BzdLbhppVwmUwUUrhmB83e9inEe
  # 3.4 Client Secret: BngAuX1zthtYnyAxPePAwyTqDxfVSq09IDRUTAonRcogYmhnfj39eBk709nKF4ej1OT7OMiJWVYIrwOrdizTFiyQxapQUEpDziPNucs5yxIciEx21PkK82IgURILL06h
  # 3.5 Redirect URIs/Orgins (RegEx): Click add
  # 3.6 select "Strict" and enter "http://openwebui.localhost/oauth/oidc/callback"
  # note that it is http and not https when we use localhost
  # 3.7 Click Next
  # 4. On Configure Bindings click next (All authenticated Authentik users can access OpenWebUI dev environment )
  # 5. Review the Application and Provider click Submit

  # OAuth2/OIDC configuration for Open WebUI + Authentik integration
  OPENWEBUI_ENABLE_OAUTH_SIGNUP: "true"
  OPENWEBUI_OAUTH_MERGE_ACCOUNTS_BY_EMAIL: "true"
  OPENWEBUI_OAUTH_PROVIDER_NAME: "Authentik"
  OPENWEBUI_OAUTH_CLIENT_ID: "1c37QuM0qm0g2BzdLbhppVwmUwUUrhmB83e9inEe"
  OPENWEBUI_OAUTH_CLIENT_SECRET: "BngAuX1zthtYnyAxPePAwyTqDxfVSq09IDRUTAonRcogYmhnfj39eBk709nKF4ej1OT7OMiJWVYIrwOrdizTFiyQxapQUEpDziPNucs5yxIciEx21PkK82IgURILL06h"
  OPENWEBUI_OAUTH_SCOPES: "openid email profile groups roles"

  # notice these are http and not https when we use localhost
  # Provider URL (where Open WebUI reaches Authentik)
  OPENWEBUI_OPENID_PROVIDER_URL: "http://authentik.localhost/application/o/openwebui-dev/.well-known/openid-configuration"
  # Redirect URI (where Authentik sends user back to Open WebUI)
  OPENWEBUI_OPENID_REDIRECT_URI: "http://openwebui.localhost/oauth/oidc/callback"
