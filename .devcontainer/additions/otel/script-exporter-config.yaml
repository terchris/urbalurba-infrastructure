# File: /workspace/.devcontainer/additions/otel/script-exporter-config.yaml
#
# Purpose: Configuration for ricoberger/script_exporter
#          Defines custom scripts that collect metrics and expose them via HTTP
#          for Prometheus/OTel scraping.
#
# Usage: script_exporter --config.files=/workspace/.devcontainer/additions/otel/script-exporter-config.yaml
#
# Each script is executed when the corresponding endpoint is scraped by Prometheus/OTel.
# Prometheus scrapes at the interval you define, not on a fixed schedule.
#
# Endpoints:
#   - http://localhost:9469/probe?script=devcontainer_info
#   - http://localhost:9469/metrics (built-in metrics for script_exporter itself)
#
# NOTE: Container cgroup metrics (cgroup_metrics) removed - now collected by
#       docker_stats receiver in otelcol-metrics-config.yaml

# Define the scripts to be executed
scripts:
  # Devcontainer information (installed components, OS info)
  # Executed when: Prometheus/OTel scrapes /probe?script=devcontainer_info
  # Output: Prometheus exposition format
  - name: devcontainer_info
    command: ["/workspace/.devcontainer/additions/otel/scripts/devcontainer-info.sh"]
    timeout:
      max_timeout: 5

  # K8s status detection (resource waste monitoring)
  # Executed when: Prometheus/OTel scrapes /probe?script=k8s_status
  # Output: Prometheus exposition format
  # Detects: disabled, enabled_unused, enabled_active
  - name: k8s_status
    command: ["/workspace/.devcontainer/additions/otel/scripts/rancher-vm-k8s-status.sh"]
    timeout:
      max_timeout: 10

# HTTP server configuration
# The exporter listens on this address for Prometheus scrapes
# Default: :9469
# web:
#   listen-address: ":9469"
